<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="900" viewBox="0 0 1600 900">
  <defs>
    <style><![CDATA[
      :root { --bg:#F7F5F0; --ink:#121212; --muted:#4B4B4B; --accent:#D9482B; --line:#CFC8BE; }
      text { font-family: "SF Pro Text", Helvetica, Arial, sans-serif; fill: var(--ink); }
      .title { font-size: 36px; font-weight: 600; }
      .label { font-size: 18px; text-transform: uppercase; letter-spacing: 2px; fill: var(--muted); }
      .step-title { font-size: 22px; font-weight: 600; }
      .step-body { font-size: 18px; fill: var(--muted); }
      .stroke { stroke: var(--line); stroke-width: 2; fill: none; }
      .flow { stroke: var(--accent); stroke-width: 2.6; stroke-dasharray: 8 10; animation: dash 4.6s linear infinite; }
      .grid { fill: url(#grid); animation: gridPulse 9.2s ease-in-out infinite; }

      .global-zoom { animation: globalZoom 13.8s ease-in-out infinite; transform-origin: center; transform-box: fill-box; }
      .parallax-1 { animation: parallax1 9.2s ease-in-out infinite; transform-box: fill-box; transform-origin: center; }

      .pulse { animation: pulse 3.8s ease-in-out infinite; transform-box: fill-box; transform-origin: center; }
      .pulse1 { animation-delay: 0s; }
      .pulse2 { animation-delay: 0.55s; }
      .pulse3 { animation-delay: 1.1s; }
      .pulse4 { animation-delay: 1.65s; }
      .pulse5 { animation-delay: 2.2s; }

      .sweep { animation: sweep 5.4s ease-in-out infinite; transform-box: fill-box; transform-origin: left center; }

      @keyframes dash { to { stroke-dashoffset: -200; } }
      @keyframes gridPulse { 0% { opacity: 0.28; } 50% { opacity: 0.5; } 100% { opacity: 0.28; } }
      @keyframes globalZoom { 0% { transform: scale(1);} 50% { transform: scale(1.02);} 100% { transform: scale(1);} }
      @keyframes parallax1 { 0% { transform: translateY(0);} 50% { transform: translateY(-7px);} 100% { transform: translateY(0);} }
      @keyframes pulse { 0% { transform: scale(1); opacity: 0.9; } 50% { transform: scale(1.12); opacity: 1; } 100% { transform: scale(1); opacity: 0.9; } }
      @keyframes sweep { 0% { transform: translateX(-120%);} 50% { transform: translateX(20%);} 100% { transform: translateX(140%);} }
    ]]></style>
    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" stroke="var(--line)" stroke-width="1" fill="none" opacity="0.35"/>
    </pattern>
    <linearGradient id="accentSweep" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="var(--accent)" stop-opacity="0"/>
      <stop offset="50%" stop-color="var(--accent)" stop-opacity="0.4"/>
      <stop offset="100%" stop-color="var(--accent)" stop-opacity="0"/>
    </linearGradient>
    <clipPath id="clip-line"><rect x="150" y="312" width="1300" height="16" rx="8"/></clipPath>
  </defs>

  <rect width="1600" height="900" fill="var(--bg)"/>
  <rect width="1600" height="900" class="grid"/>

  <g class="global-zoom">
    <text class="label" x="80" y="90">Training Pipeline</text>
    <text class="title" x="80" y="140">End-to-End Flow</text>

    <g clip-path="url(#clip-line)">
      <rect x="150" y="312" width="300" height="16" fill="url(#accentSweep)" class="sweep"/>
    </g>

    <line x1="150" y1="320" x2="1450" y2="320" class="stroke"/>
    <line x1="150" y1="320" x2="1450" y2="320" class="flow"/>

    <g class="parallax-1">
      <circle cx="200" cy="320" r="28" fill="var(--accent)" class="pulse pulse1"/>
      <text x="192" y="328" font-size="18" fill="#ffffff" font-weight="700">1</text>
      <text class="step-title" x="150" y="390">Data Download</text>
      <text class="step-body" x="150" y="420">Fetch and shard</text>
      <text class="step-body" x="150" y="446">large-scale text</text>

      <circle cx="470" cy="320" r="28" fill="var(--accent)" class="pulse pulse2"/>
      <text x="462" y="328" font-size="18" fill="#ffffff" font-weight="700">2</text>
      <text class="step-title" x="420" y="390">Preprocess</text>
      <text class="step-body" x="420" y="420">Clean samples</text>
      <text class="step-body" x="420" y="446">and split long text</text>

      <circle cx="740" cy="320" r="28" fill="var(--accent)" class="pulse pulse3"/>
      <text x="732" y="328" font-size="18" fill="#ffffff" font-weight="700">3</text>
      <text class="step-title" x="690" y="390">Autoencoder</text>
      <text class="step-body" x="690" y="420">Train latent</text>
      <text class="step-body" x="690" y="446">compression stage</text>

      <circle cx="1010" cy="320" r="28" fill="var(--accent)" class="pulse pulse4"/>
      <text x="1002" y="328" font-size="18" fill="#ffffff" font-weight="700">4</text>
      <text class="step-title" x="960" y="390">Continuous Model</text>
      <text class="step-body" x="960" y="420">Energy / diffusion</text>
      <text class="step-body" x="960" y="446">or flow head</text>

      <circle cx="1280" cy="320" r="28" fill="var(--accent)" class="pulse pulse5"/>
      <text x="1272" y="328" font-size="18" fill="#ffffff" font-weight="700">5</text>
      <text class="step-title" x="1230" y="390">Evaluation</text>
      <text class="step-body" x="1230" y="420">BrierLM scoring</text>
      <text class="step-body" x="1230" y="446">and sampling checks</text>
    </g>

    <circle r="5" fill="var(--accent)">
      <animateMotion dur="5.4s" repeatCount="indefinite" path="M 150 320 L 1450 320"/>
    </circle>

    <text class="step-body" x="80" y="600">Tip: keep block size a multiple of patch size to avoid partial patch truncation.</text>
  </g>
</svg>
